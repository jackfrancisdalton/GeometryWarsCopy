/*!CK:1677469906!*//*1392704823,178191169*/

if (self.CavalryLogger) { CavalryLogger.start_js(["hJ5S0"]); }

__d("EntstreamStoryDeduper",["DOM","csx"],function(a,b,c,d,e,f,g,h){var i={dedupe:function(j,k){k=k||"._5jmm";var l=g.scry(j,k);l=l.filter(function(q){return q.getAttribute('data-dedupekey');});var m={};for(var n=0;n<l.length;n++){var o=l[n],p=o.getAttribute('data-dedupekey');if(m[p]){g.remove(o);}else m[p]=1;}}};e.exports=i;});
__d("LitestandNewStoryController",["Animation","Arbiter","AsyncRequest","DOM","EntstreamStoryDeduper","LitestandMessages","LitestandStream","Run","Style","$","queryThenMutateDOM"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){var r=600,s=500,t,u,v;function w(){h.unsubscribe(v);v=null;x();}function x(){y();t&&j.remove(t);t=null;}function y(){u&&clearTimeout(u);u=null;}function z(){u=setTimeout(function(){u=null;aa();},s);}function aa(){var da;q(function(){da=m.canInsertNewerStories();},function(){if(da){ba();}else z();},'LitestandNewStoryController/tryShowingStories');}function ba(){y();if(!t)return;k.dedupe(m.getStreamRoot(),m.getStoriesSelector());o.apply(t,{left:'',position:''});new g(t).from('opacity',0).to('opacity',1).duration(r).go();h.inform(l.STORIES_INSERTED);h.inform(l.NEWER_STORIES_INSERTED);h.inform('reflow');new i().setURI('/ajax/litestand/update_filter_viewtime').setData({section_id:m.getSectionID()}).send();t=null;}var ca={waitForDisplay:function(da){if(!v){v=h.subscribe(l.FILTER_SWITCH_BEGIN,x);n.onLeave(w);}if(!t)t=p(da);if(m.canInsertNewerStories()){ba();}else z();}};e.exports=ca;});